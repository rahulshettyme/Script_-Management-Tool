{
  "description": "Script Name: AddVarietyWithCropStage\nExcel Columns: name,nickName,expectedHarvestDays,cropName,cropId,expectedYield,expectedYieldUnits,refrenceAreaUnits,cropStagename,cropStagedaysAfterSowing,cropstagedata,varietyID\n\nStep 1 [API]:\n  - Step/Variable Name: /services/farm/api/crop-stages\n  - Call GET /services/farm/api/crop-stages\n  - Run Once: Yes (Master Data / Setup Step)\n  - Payload Type: QUERY\n  - Expected Response: [ {  \"id\" : 99152,  \"name\" : \"2-Sown\",  \"description\" : null,  \"daysAfterSowing\" : null,  \"imageUrl\" : null,  \"clientId\" : \"c54000c2-58b1-49a9-839e-32884ba61dac\"}, {  \"id\" : 99002,  \"name\" : \"3-Transplanting\",  \"description\" : null,  \"daysAfterSowing\" : null,  \"imageUrl\" : null,  \"clientId\" : \"6bbfad86-d78e-49f1-9350-7f1c599d04e9\"}, {  \"id\" : 99052,  \"name\" : \"4-Blooming, pollination, maturing\",  \"description\" : null,  \"daysAfterSowing\" : null,  \"imageUrl\" : null,  \"clientId\" : \"8206e270-6901-48b3-9a22-8f2b5d053e2c\"}, {  \"id\" : 99102,  \"name\" : \"5-Harvesting\",  \"description\" : null,  \"daysAfterSowing\" : null,  \"imageUrl\" : null,  \"clientId\" : \"2c0616ad-f3fc-4e16-bfec-ac3b56871772\"} ]\n  - Instructions: hit the API only once. Get the response and use for all rows, compare response attribute \"name\" for column 'cropStagename'. write the response for each name in column 'cropstagedata' by replacing attribute 'daysAfterSowing' with the numeric value in column 'cropStagedaysAfterSowing', if empty 'cropStagedaysAfterSowing' use same as in response. If not found, write as 'Invalid Crop Stage'\n\nStep 2 [API]:\n  - Step/Variable Name: Crop API\n  - Call GET /services/farm/api/crops?size=1000\n  - Run Once: Yes (Master Data / Setup Step)\n  - Payload Type: QUERY\n  - Expected Response: [ {  \"id\" : 42851,  \"name\" : \"Brinjal\",  \"data\" : null,  \"parentId\" : null,  \"description\" : \"Brinjal Crop Description\",  \"alias\" : \"BRJ\",  \"srCropId\" : 40,  \"srCropCode\" : \"Brinjal\",  \"clientId\" : \"54dd149f-da01-4fe1-bb14-97c6a2c019f0\",  \"imageUrl\" : \"https://smartfarmplus-static.s3.ap-southeast-1.amazonaws.com/crop-images/brinjal.png\",  \"dewsEnabled\" : false}, {  \"id\" : 1001,  \"name\" : \"Wheat1\",  \"data\" : null,  \"parentId\" : null,  \"description\" : \"Wheat Crop Description\",  \"alias\" : \"WHT\",  \"srCropId\" : 23,  \"srCropCode\" : null,  \"clientId\" : \"72dd5baa-ebc8-4328-a290-98f6c2bfb7da\",  \"imageUrl\" : \"https://smartfarmplus-static.s3.ap-southeast-1.amazonaws.com/crop-images/wheat.png\",  \"dewsEnabled\" : false}]\n  - Instructions: Hit this API only once, get 'id' attribute for the column 'cropName' and update id in 'cropId' column. use the same response for all rows\n\nStep 3 [LOGIC]:\n  - Logic: Create a static variable as \"locations\" and use below as values for the variable\n{\n                    \"bounds\": {\n                        \"northeast\": {\n                            \"lat\": 72.7087158,\n                            \"lng\": -66.3193754\n                        },\n                        \"southwest\": {\n                            \"lat\": 15.7760139,\n                            \"lng\": -173.2992296\n                        }\n                    },\n                    \"country\": \"United States\",\n                    \"placeId\": \"ChIJCzYy5IS16lQRQrfeQ5K5Oxw\",                    \"latitude\": 38.7945952,\n                    \"longitude\": -106.5348379,\n                    \"geoInfo\": {\n                        \"type\": \"FeatureCollection\",\n                        \"features\": [{\n                                \"type\": \"Feature\",\n                                \"properties\": {},\n                                \"geometry\": {\n                                    \"type\": \"Polygon\",\n                                    \"coordinates\": [[[-173.2992296, 15.7760139], [-66.3193754, 15.7760139], [-66.3193754, 72.7087158], [-173.2992296, 72.7087158], [-173.2992296, 15.7760139]]]\n                                }\n                            }\n                        ]\n                    },\n                    \"name\": \"United States\"\n                }\n\nStep 4 [API]:\n  - Step/Variable Name: Add Variety API\n  - Call POST /services/farm/api/varieties\n  - Payload Type: JSON\n  - Payload Example: {    \"data\": {        \"yieldPerLocation\": [{                \"data\": {},                \"locations\": {                    \"bounds\": {                        \"northeast\": {                            \"lat\": 72.7087158,                            \"lng\": -66.3193754                        },                        \"southwest\": {                            \"lat\": 15.7760139,                            \"lng\": -173.2992296                        }                    },                    \"country\": \"United States\",                    \"placeId\": \"ChIJCzYy5IS16lQRQrfeQ5K5Oxw\",                    \"latitude\": 38.7945952,                    \"longitude\": -106.5348379,                    \"geoInfo\": {                        \"type\": \"FeatureCollection\",                        \"features\": [{                                \"type\": \"Feature\",                                \"properties\": {},                                \"geometry\": {                                    \"type\": \"Polygon\",                                    \"coordinates\": [[[-173.2992296, 15.7760139], [-66.3193754, 15.7760139], [-66.3193754, 72.7087158], [-173.2992296, 72.7087158], [-173.2992296, 15.7760139]]]                                }                            }                        ]                    },                    \"name\": \"United States\"                },                \"expectedYield\": 999,                \"expectedYieldQuantity\": \"\",                \"expectedYieldUnits\": \"KILOGRAM\",                \"refrenceAreaUnits\": \"ACRE\"            }        ]    },    \"cropId\": 1728101,    \"name\": \"RS Test API Create Carrot 2\",    \"nickName\": \"RSTACC2\",    \"expectedHarvestDays\": 120,    \"processStandardDeduction\": null,    \"cropPrice\": null,    \"cropStages\": [],    \"seedGrades\": [],    \"harvestGrades\": [],    \"id\": null,    \"varietyAdditionalAttributeList\": []}\n  - Expected Response: {    \"id\": 3785102,    \"name\": \"RS Test API Create Carrot 3\",    \"description\": null,    \"expectedHarvestDays\": 120,    \"expectedQuantityPerAcre\": null,    \"rejectionPercentage\": null,    \"harvestUnitId\": null,    \"processStandardDeduction\": null,    \"daysForPreHarvestSampling\": null,    \"preferredSKUTypeId\": null,    \"stripTestFlag\": null,    \"autoArchivePlotFlag\": null,    \"autoArchivePlotDays\": null,    \"data\": {        \"yieldPerLocation\": [            {                \"data\": {},                \"locations\": {                    \"id\": null,                    \"name\": \"USA\",                    \"administrativeAreaLevel5\": null,                    \"administrativeAreaLevel4\": null,                    \"administrativeAreaLevel3\": null,                    \"administrativeAreaLevel2\": null,                    \"administrativeAreaLevel1\": null,                    \"country\": null,                    \"latitude\": null,                    \"longitude\": null,                    \"sublocalityLevel1\": null,                    \"sublocalityLevel2\": null,                    \"sublocalityLevel3\": null,                    \"sublocalityLevel4\": null,                    \"sublocalityLevel5\": null,                    \"geoInfo\": null,                    \"bounds\": null,                    \"placeId\": null                },                \"expectedYield\": 999,                \"expectedYieldQuantity\": \"\",                \"expectedYieldUnits\": \"KILOGRAM\",                \"refrenceAreaUnits\": \"ACRE\"            }        ],        \"companyYieldPerLocation\": [            {                \"expectedYield\": 999.0,                \"expectedYieldUnits\": \"KILOGRAM\",                \"refrenceAreaUnits\": \"ACRE\"            }        ]    },    \"parentId\": null,    \"cropId\": 1728101,    \"cropName\": \"Carrot\",    \"srVarietyId\": null,    \"srCropCode\": \"Carrot\",    \"clientId\": \"0af8b8da-abaf-48a1-9607-5aa65417439e\",    \"nickName\": \"RSTACC3\",    \"cropKey\": null,    \"subCompanyIds\": null,    \"companyId\": 1251,    \"seedGrades\": [],    \"harvestGrades\": [],    \"varietyAdditionalAttributes\": [],    \"deleted\": false,    \"cropStages\": [{            \"id\": 3785552,            \"name\": \"RS Test 1\",            \"description\": null,            \"daysAfterSowing\": 10,            \"imageUrl\": null,            \"clientId\": \"d6443380-0f0e-4c5b-895e-376f36147d62\"        }, {            \"id\": 3785602,            \"name\": \"RS Test 2\",            \"description\": null,            \"daysAfterSowing\": 30,            \"imageUrl\": null,            \"clientId\": \"7c5e3eca-ff02-4512-aae6-3667144ddbb8\"        }]}\n  - Instructions: create payload from below values  1. yieldPerLocation.locations - same as static variable 'locations'  2. yieldPerLocation.expectedYield from expectedYield column  3. yieldPerLocation.expectedYieldUnits from expectedYieldUnits column  4. yieldPerLocation.refrenceAreaUnits from refrenceAreaUnits column  5. 'cropId' from extracted cropId in column 'cropId'  6. 'name' from column 'name'  7. 'nickName' from column nickName  8. 'expectedHarvestDays' from column expectedHarvestDays  9. 'cropStages' using column 'cropstagedata' with comma separated for multiple cropstages on the next row check for the 'name', if it is same, directly check the 'cropStagename' and add its 'cropstagedata' in the payload and continue same till next different name found. 1 API call should have 'name' with all its 'cropStagename' details. use only valid detected data ignore the invalid cropstages. use cropstages without days also\n\nStep 5 [LOGIC]:\n  - Logic: 1. add 2 columns status and API response. Add the result accordingly.\n2. Save the value of attribute 'id' in column 'varietyID'\n3. If the response code is 400, write the attribute 'title' value in API Response\n\n",
  "inputColumns": [],
  "team": "QA",
  "groupByColumn": "name",
  "isMultithreaded": false,
  "batchSize": 10,
  "mtime": 1768821485078
}