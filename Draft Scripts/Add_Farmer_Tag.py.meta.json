{
  "description": "Add tags to farmers. \nNote: This script will update tag in excel to existing tags. It wont delete the existing tag.",
  "generationPrompt": "Script Name: Add_Farmer_Tag\nExcel Columns: Farmer Name, Farmer ID, Tag Name, Tag ID, Status, Response\n\nOUTPUT MAPPING CONFIGURATION:\n- UI Output Definition:\n- UI Column 'Farmer Name': Set to '' (Logic: from excel)\n- UI Column 'Farmer ID': Set to '' (Logic: from excel)\n- UI Column 'Tag Name': Set to '' (Logic: from excel)\n- UI Column 'Status': Set to '' (Logic: Pass if farmer update API status code is 200, else Fail)\n- Excel Output Definition:\n   - Column 'Tag ID': Set to '' (Logic: attribute 'id' from tag API response)\n   - Column 'Status': Set to '' (Logic: 'Fail' if tag not found or if status code of farmer update is not 200\n'Pass' if status of farmer update is 200)\n   - Column 'Response': Set to '' (Logic: 'Tag not found' if tag not found or \nwhole response of farmer update if status code is not 200\n'Tag updated to farmer' if farmer update response code is 200)\nIMPORTANT: Include this configuration as a comment block at the top of the generated Python script for reference.\n\nStep 1 [API]:\n  - Step/Variable Name: Fetch Master Tags\n  - Call GET /services/master/api/filter?type=FARMER\n  - Run Once: Yes (Master Data / Setup Step)\n  - Payload Type: QUERY\n  - Payload Example: {\"type\": \"FARMER\"}\n  - Expected Response: [ {  \"id\" : 3410601,  \"name\" : \"testpavan\",  \"clientId\" : \"ce804f83-95d5-4c07-8628-3f7aa60df5e7\",  \"tagType\" : \"FARMER\",  \"validFrom\" : \"2025-07-01T00:00:00Z\",  \"validTill\" : \"2026-07-09T00:00:00Z\",  \"status\" : \"Active\",  \"description\" : null}, {  \"id\" : 3591201,  \"name\" : \"RS Multi Project Farmer\",  \"clientId\" : \"783f0712-c671-455b-ad8e-81941f53b7d7\",  \"tagType\" : \"FARMER\",  \"validFrom\" : \"2025-07-01T00:00:00Z\",  \"validTill\" : \"2026-07-09T00:00:00Z\",  \"status\" : \"Active\",  \"description\" : null}, {  \"id\" : 5883651,  \"name\" : \"Raja farmer tag 01\",  \"clientId\" : \"e038b6c3-6910-4119-a723-1afc4399a356\",  \"tagType\" : \"FARMER\",  \"validFrom\" : \"2025-07-01T00:00:00Z\",  \"validTill\" : \"2025-07-31T00:00:00Z\",  \"status\" : \"Active\",  \"description\" : null}]\n  - Instructions: Fetches a map of tag names to tag IDs for 'FARMER' type. validate the response attribute 'name' with excel column 'Tag Name'. If the name matches, add the response attribute 'id' value in column 'Tag ID'. If not found, add 'Status' column as 'Fail' and add 'Response' column value as 'Tag not found' Skip the row execution if tag not found\n\nStep 2 [API]:\n  - Step/Variable Name: Fetch Farmer Details\n  - Call GET /services/farm/api/farmers/{Farmer ID}\n  - Payload Type: QUERY\n  - Expected Response: {  \"id\" : 5775643,  \"firstName\" : \"0805- bulk fill\",  \"lastName\" : null,  \"gender\" : null,  \"images\" : {    \"butterfly1770016526324.jpeg\" : \"data.profilePic\"  },  \"status\" : \"DISABLE\",  \"data\" : {    \"rajaNewAddAttr02\" : \"test2\",    \"rajaNewAddAttr03\" : 888,    \"rajaNewAddAttr01\" : \"test\",    \"countryIsoCode\" : \"IN\",    \"countryCode\" : \"+91\",    \"mobileNumber\" : \"87654678\",    \"profilePic\" : [ {      \"size\" : 7648,      \"active\" : true,      \"channel\" : \"web\",      \"feature\" : \"farmer\",      \"imageLat\" : null,      \"imageLong\" : null,      \"imageType\" : \"profile\",      \"identifier\" : \"a642eacd-c01e-47be-8d60-3018b36630ba\",      \"contentType\" : \"image/jpeg\",      \"imageSource\" : null,      \"capturedDateTime\" : null,      \"originalFileName\" : \"butterfly1770016526324.jpeg\"    } ],    \"profileImage\" : [ ],    \"tags\" : [ 5921851 ]  },  \"contractorId\" : null,  \"contractorName\" : null,  \"contractorLocation\" : null,  \"clientId\" : \"4ee03ec9-cbb2-4a85-b9b4-b6051888701d\",  \"declaredArea\" : null,  \"address\" : {    \"id\" : 5776162,    \"formattedAddress\" : \"Madhugiri, Karnataka 572132, India\",    \"postalCode\" : \"572132\",    \"locality\" : \"Madhugiri\",    \"data\" : null,    \"administrativeAreaLevel5\" : null,    \"administrativeAreaLevel4\" : null,    \"administrativeAreaLevel3\" : null,    \"administrativeAreaLevel2\" : \"Bangalore Division\",    \"administrativeAreaLevel1\" : \"Karnataka\",    \"country\" : \"India\",    \"latitude\" : 13.6643166,    \"longitude\" : 77.20889869999999,    \"placeId\" : \"ChIJsfkoVqO0sTsRLbvVqd06cTU\",    \"sublocalityLevel1\" : \"\",    \"sublocalityLevel2\" : \"\",    \"sublocalityLevel3\" : null,    \"sublocalityLevel4\" : null,    \"sublocalityLevel5\" : null,    \"houseNo\" : \"\",    \"buildingName\" : \"\",    \"landmark\" : \"\",    \"clientId\" : \"9029326d-a380-4ad8-ac29-a6b754aede64\"  },  \"farmerCode\" : \"0805- bulk fill\",  \"isDeleted\" : false,  \"email\" : null,  \"deviceToken\" : null,  \"deviceType\" : null,  \"isAcreSquareEnabled\" : null,  \"isGDPRCompliant\" : true,  \"companyId\" : 1251,  \"createdDate\" : \"2025-05-08T09:23:02.964Z\",  \"lastModifiedDate\" : \"2026-02-02T07:15:33.259Z\",  \"loginType\" : null,  \"externalId\" : null,  \"assignedTo\" : [ {    \"id\" : 1551,    \"name\" : \"Sub Admin1\",    \"data\" : {      \"geoIds\" : [ 656497 ],      \"environment\" : \"dev\",      \"countryIsoCode\" : \"IN\",      \"srRegionEnabled\" : true,      \"isExecutiveProfileEnabled\" : false,      \"isSREnabled\" : true    },    \"assignedManagersName\" : [ ],    \"conversionFactor\" : null,    \"managers\" : [ 6501, 2951, 1401, 1801 ],    \"userStatus\" : \"ACTIVE\",    \"location\" : null,    \"contactNumber\" : \"1111111111\",    \"email\" : \"Subadmin12@cropin.com\",    \"preferences\" : {      \"id\" : 1601,      \"currency\" : \"INR\",      \"language\" : \"en\",      \"timeZone\" : \"IST\",      \"areaUnits\" : \"ACRE\",      \"locale\" : \"en-IN\",      \"data\" : {        \"cropPreferences\" : [ ],        \"cropUnit\" : \"Tons\",        \"planTypePreferences\" : [ ],        \"farmerTag\" : [ ],        \"assetTag\" : [ ],        \"caTag\" : [ ],        \"precipitationUnit\" : \"Millimeters\",        \"tempratureUnit\" : \"Celsius\"      },      \"locations\" : null    },    \"address\" : null,    \"assignedTo\" : null,    \"managersName\" : null,    \"companyId\" : 1251,    \"parentCompanyId\" : null,    \"userRoleId\" : 1351,    \"userRoleName\" : \"ROLE_ADMIN\",    \"correspondingKcId\" : null,    \"resources\" : null,    \"countryCode\" : \"+91\",    \"companyStatus\" : null,    \"clientId\" : \"f146aa1e-d40b-46df-8c97-29ca50a18c18\",    \"images\" : { },    \"companyPreferences\" : null,    \"locations\" : {      \"id\" : 1501,      \"name\" : \"Bengaluru\",      \"administrativeAreaLevel5\" : null,      \"administrativeAreaLevel4\" : null,      \"administrativeAreaLevel3\" : null,      \"administrativeAreaLevel2\" : \"Bangalore Urban\",      \"administrativeAreaLevel1\" : \"Karnataka\",      \"country\" : \"India\",      \"latitude\" : null,      \"longitude\" : null,      \"sublocalityLevel1\" : null,      \"sublocalityLevel2\" : null,      \"sublocalityLevel3\" : null,      \"sublocalityLevel4\" : null,      \"sublocalityLevel5\" : null,      \"geoInfo\" : {        \"type\" : \"FeatureCollection\",        \"features\" : [ {          \"type\" : \"Feature\",          \"geometry\" : {            \"type\" : \"Polygon\",            \"coordinates\" : [ [ [ 77.37919807560223, 12.73428884772176 ], [ 77.88268086666527, 12.73428884772176 ], [ 77.88268086666527, 13.17370600858147 ], [ 77.37919807560223, 13.17370600858147 ], [ 77.37919807560223, 12.73428884772176 ] ] ]          },          \"properties\" : { }        } ]      },      \"bounds\" : {        \"southwest\" : {          \"lat\" : 12.73428884772176,          \"lng\" : 77.37919807560223        },        \"northeast\" : {          \"lat\" : 13.17370600858147,          \"lng\" : 77.88268086666527        }      },      \"placeId\" : \"ChIJbU60yXAWrjsR4E9-UejD3_g\"    },    \"enabled\" : true,    \"isAcreSquareUser\" : false,    \"isGDPRCompliant\" : true,    \"lastModifiedDate\" : \"2026-02-03T06:21:08.795Z\",    \"loginType\" : null,    \"executiveRoleUser\" : false,    \"preferredName\" : \"1234560001\",    \"deviceToken\" : \"ei_Gol0VS3mCl44FmAv2nn:APA91bGxCCpGgpy7zdvAfmbl2Z0HFKLmJDHEfPuxxASeCrd834nbAn5iaoe3pU3ljTWlDb4BMBknaUPxLLAQ3Dr-VIuYSLZ7Hw8o-wFa9B-rbgu6_QwJb1E\",    \"deviceType\" : \"samsung/a31xx/a31:12/SP1A.210812.016/A315FXXU4DWI2:user/release-keysSM-A315F\",    \"createdBy\" : \"1401\",    \"lastModifiedBy\" : \"1551\",    \"deleted\" : false  } ],  \"massUpload\" : false,  \"deleted\" : false,  \"acreSquareEnabled\" : null}\n  - Instructions: Fetches the complete details of the target farmer using the resolved farmer ID.\n\nStep 3 [LOGIC]:\n  - Logic: Extracts current tags from farmer_data['data']['tags']. If the resolved tag_id is not already present, it's added to the list of tags. Prepares the farmer_data object for the PUT request.\n\nStep 4 [API]:\n  - Step/Variable Name: Update Farmer Tags\n  - Call PUT /services/farm/api/farmers\n  - Payload Type: DTO_FILE\n  - Payload Example: {\"dto\": {\"data\": {\"tags\": [\"list of tag IDs\"]}}} | Structure: Updates nested data.data (array)\n  - Expected Response: put_resp\n  - Instructions: Sends the updated farmer_data (including new tags) to the API to update the farmer. Only executed if a new tag was added. If the response code is 200, add 'Status' column as 'Pass' and add 'Response' column value as 'Tag updated to farmer' if response is not 200, add 'Status' column as 'Fail' and add whole response in column 'Response'\n\n",
  "inputColumns": [
    "Tag ID",
    "Response"
  ],
  "team": "QA",
  "groupByColumn": "",
  "isMultithreaded": true,
  "enableGeofencing": false,
  "batchSize": 10,
  "outputConfig": {
    "uiMapping": [
      {
        "colName": "Farmer Name",
        "value": "",
        "logic": "from excel"
      },
      {
        "colName": "Farmer ID",
        "value": "",
        "logic": "from excel"
      },
      {
        "colName": "Tag Name",
        "value": "",
        "logic": "from excel"
      },
      {
        "colName": "Status",
        "value": "",
        "logic": "Pass if farmer update API status code is 200, else Fail"
      }
    ],
    "aiInstructions": "",
    "excelMapping": [
      {
        "colName": "Tag ID",
        "value": "",
        "logic": "attribute 'id' from tag API response"
      },
      {
        "colName": "Status",
        "value": "",
        "logic": "'Fail' if tag not found or if status code of farmer update is not 200\n'Pass' if status of farmer update is 200"
      },
      {
        "colName": "Response",
        "value": "",
        "logic": "'Tag not found' if tag not found or \nwhole response of farmer update if status code is not 200\n'Tag updated to farmer' if farmer update response code is 200"
      }
    ],
    "isDynamicUI": true
  },
  "mtime": 1770124323650
}