{
  "description": "Add farmer by searching the User using the name provided\nNote: If tenant has additional attributes, select the checkbox and mention attribute key to get column in Excel",
  "generationPrompt": "Script Name: AddFarmer\nExcel Columns: Farmer Name, Farmer Code, Phone Number, AssignedTo, UserID, Address, Address Component (non mandatory), Status, Farmer ID, Response\n\nOUTPUT MAPPING CONFIGURATION:\n- UI Output Definition:\n- UI Column 'Farmer Name': Set to 'Farmer Name' (Logic: from excel column 'Farmer Name')\n- UI Column 'Status': Set to '' (Logic: 'Pass' if Farmer create response in 200, else 'Fail')\n- UI Column 'Farmer ID': Set to '' (Logic: attribute 'id' from response of farmer create if status is pass, else 'NA')\n- Excel Output Definition:\n   - Column 'UserID': Set to 'user response id' (Logic: id from user fetch is user found)\n   - Column 'Status': Set to 'Pass or Fail' (Logic: 'Pass' if Farmer create response in 200, else 'Fail')\n   - Column 'Farmer ID': Set to 'id' (Logic: id from farmer create response if farmer created successfully)\n   - Column 'Response': Set to '' (Logic: 'Farmer Created Successfully' if farmer creation is success\nor 'User not Found' is user find is failed\nActual response if farmer creation failed)\nIMPORTANT: Include this configuration as a comment block at the top of the generated Python script for reference.\n\nStep 1 [GEO]:\n  - Geo Location Logic: Create address component for each row using the column 'Address' for each row as below. Add a new column as 'Address Component (non mandatory)' to save this address. If the address is repeated in any row, use same result dont hit APIs again\n\n{\n    \"id\" : 5827070,\n    \"formattedAddress\" : \"Madhugiri, Karnataka 572132, India\",\n    \"postalCode\" : \"572132\",\n    \"locality\" : \"Madhugiri\",\n    \"data\" : null,\n    \"administrativeAreaLevel5\" : null,\n    \"administrativeAreaLevel4\" : null,\n    \"administrativeAreaLevel3\" : null,\n    \"administrativeAreaLevel2\" : \"Bangalore Division\",\n    \"administrativeAreaLevel1\" : \"Karnataka\",\n    \"country\" : \"India\",\n    \"latitude\" : 13.6643166,\n    \"longitude\" : 77.20889869999999,\n    \"placeId\" : \"ChIJsfkoVqO0sTsRLbvVqd06cTU\",\n    \"sublocalityLevel1\" : \"\",\n    \"sublocalityLevel2\" : \"\",\n    \"sublocalityLevel3\" : null,\n    \"sublocalityLevel4\" : null,\n    \"sublocalityLevel5\" : null,\n    \"houseNo\" : \"\",\n    \"buildingName\" : \"\",\n    \"landmark\" : \"\",\n    \"clientId\" : \"4b5c78b1-7579-4a59-8e8e-8bd35b738b8e\"\n  }\n  - IMPORTANT: You MUST import and use 'components.geofence_utils' for this step.\n  - Usage: boundary_data = geofence_utils.get_boundary(location_name, env_config.get('google_api_key'))\n  - CRITICAL: 'boundary_data' IS the direct result object. It is NOT wrapped in 'google_response' or 'data'.\n  - 'boundary_data' structure: { \"formatted_address\": \"...\", \"geometry\": { \"location\": {...}, \"viewport\": {...}, \"bounds\": {...} }, \"place_id\": \"...\", \"address_components\": [...], \"geojson_polygon\": {...} }\n  - NOTE: 'geojson_polygon' is ALREADY a FeatureCollection. DO NOT wrap it in another FeatureCollection or check for 'Polygon' type.\n  - CRITICAL: When mapping 'bounds' and 'geoInfo', ALWAYS prioritize 'geometry.bounds' over 'geometry.viewport' if available, as 'bounds' is the strict geopolitical boundary.\n  - CRITICAL: The final Output column MUST be a JSON string. Use 'json.dumps(output_payload)' to populate the row.\n  - YOU MUST PARSE 'boundary_data' directly to extract fields required by the logic (e.g. boundary_data['formatted_address'], boundary_data['geometry']['location']).\n\nStep 2 [MASTER]:\n  - Master Type: user\n  - Input Column: AssignedTo\n  - Output Column: UserID\n  - Lookup Path: id\n  - On Failure: Skip Row\n  - Run Method: search\n  - IMPORTANT: You MUST import and use 'components.master_search' for this step.\n  - The master_data_config is available in env_config, so master_search will auto-detect run_method (usually 'search').\n\nStep 3 [API]:\n  - Step/Variable Name: Create Farmer\n  - Call POST /services/farm/api/farmers\n  - Payload Type: DTO_FILE\n  - Payload Example: {    \"data\": {        \"mobileNumber\": \"9126050202\",        \"countryCode\": \"+91\"    },    \"firstName\": \"RS test 050202\",    \"farmerCode\": \"rstest050202\",    \"assignedTo\": [{            \"id\": 1401,            \"name\": \"RS Test Admin\"        }    ],    \"address\": {        \"country\": \"India\",        \"formattedAddress\": \"Madhugiri, Karnataka 572132, India\",        \"houseNo\": \"\",        \"buildingName\": \"\",        \"administrativeAreaLevel1\": \"Karnataka\",        \"locality\": \"Madhugiri\",        \"administrativeAreaLevel2\": \"Bangalore Division\",        \"sublocalityLevel1\": \"\",        \"sublocalityLevel2\": \"\",        \"landmark\": \"\",        \"postalCode\": \"572132\",        \"placeId\": \"ChIJsfkoVqO0sTsRLbvVqd06cTU\",        \"latitude\": 13.6643166,        \"longitude\": 77.20889869999999    }}\n  - Instructions: Create payload using excel as below 1. Attributes 'data.mobileNumber' and 'data.countryCode' using column 'Phone Number' which will have value in the format '91 7259123456' or '+91 7259123456'. If + is missing add yourself for attribute 2. Attribute 'firstName' using column 'Farmer Name' 3. attribute 'farmerCode' using column Farmer Code 4. attribute 'assignedTo.id' using user response fetched value in column 'UserID' 5. attribute 'assignedTo.name' using column 'AssignedTo' 6. attribute 'address' using parsed adress value in column 'Address Component (non mandatory)' If the response code is 400, add the attribute 'title' value in excel column 'Response'\n\n",
  "inputColumns": [],
  "team": "Unassigned",
  "groupByColumn": "",
  "isMultithreaded": true,
  "enableGeofencing": false,
  "allowAdditionalAttributes": true,
  "additionalAttributes": [],
  "batchSize": 10,
  "outputConfig": {
    "uiMapping": [
      {
        "colName": "Farmer Name",
        "value": "Farmer Name",
        "logic": "from excel column 'Farmer Name'"
      },
      {
        "colName": "Status",
        "value": "",
        "logic": "'Pass' if Farmer create response in 200, else 'Fail'"
      },
      {
        "colName": "Farmer ID",
        "value": "",
        "logic": "attribute 'id' from response of farmer create if status is pass, else 'NA'"
      }
    ],
    "aiInstructions": "",
    "excelMapping": [
      {
        "colName": "UserID",
        "value": "user response id",
        "logic": "id from user fetch is user found"
      },
      {
        "colName": "Status",
        "value": "Pass or Fail",
        "logic": "'Pass' if Farmer create response in 200, else 'Fail'"
      },
      {
        "colName": "Farmer ID",
        "value": "id",
        "logic": "id from farmer create response if farmer created successfully"
      },
      {
        "colName": "Response",
        "value": "",
        "logic": "'Farmer Created Successfully' if farmer creation is success\nor 'User not Found' is user find is failed\nActual response if farmer creation failed"
      }
    ],
    "isDynamicUI": true
  },
  "mtime": 1771087914400
}